---
# Source: uyuni-suite/charts/mariadb/templates/serviceaccount.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: mariadb
  namespace: "release-5"
  labels:
    app.kubernetes.io/name: mariadb
    helm.sh/chart: mariadb-11.4.5
    app.kubernetes.io/instance: uyuni-suite
    app.kubernetes.io/managed-by: Helm
  annotations:
automountServiceAccountToken: false
---
# Source: uyuni-suite/charts/mariadb/templates/secrets.yaml
apiVersion: v1
kind: Secret
metadata:
  name: mariadb
  namespace: "release-5"
  labels:
    app.kubernetes.io/name: mariadb
    helm.sh/chart: mariadb-11.4.5
    app.kubernetes.io/instance: uyuni-suite
    app.kubernetes.io/managed-by: Helm
type: Opaque
data:
  mariadb-root-password: "cm9vdA=="
  mariadb-password: "dXl1bmlQYXNzd29yZDMj"
---
# Source: uyuni-suite/templates/kube-config-secret.yaml
apiVersion: v1
kind: Secret
metadata:
  name: kube-config
  namespace: release-5
type: Opaque
data:
  config: |-
      YXBpVmVyc2lvbjogdjEKY2x1c3RlcnM6Ci0gY2x1c3RlcjoKICAgIGNlcnRpZmljYXRlLWF1dGhvcml0eS1kYXRhOiBMUzB0TFMxQ1JVZEpUaUJEUlZKVVNVWkpRMEZVUlMwdExTMHRDazFKU1VNdmFrTkRRV1ZoWjBGM1NVSkJaMGxDUVVSQlRrSm5hM0ZvYTJsSE9YY3dRa0ZSYzBaQlJFRldUVkpOZDBWUldVUldVVkZFUlhkd2NtUlhTbXdLWTIwMWJHUkhWbnBOUWpSWVJGUkplVTFVUVhoT1JFRTBUV3BuZWsxV2IxaEVWRTE1VFZSQmVFMVVRVFJOYW1kNlRWWnZkMFpVUlZSTlFrVkhRVEZWUlFwQmVFMUxZVE5XYVZwWVNuVmFXRkpzWTNwRFEwRlRTWGRFVVZsS1MyOWFTV2gyWTA1QlVVVkNRbEZCUkdkblJWQkJSRU5EUVZGdlEyZG5SVUpCU3pWMUNpOWtjVFpyZW1GRWJsQTVRMnhDWVdVcmJrRXlPRVJNVVZZNEx6WTRWRnBFWW1wdE4yb3ZTSEpTVXpnd1NXaEZTVGh4VW5ab1owRnVRVVpyT1dVeVpYZ0thbWRYVGt4SU1tOUVWVTl5UTFkbGFHZGpXVFpoU0UxT2JVMHdWalJpZEZsNGJXaHZWVlpYY3pkdlFVdGtPVzl4UXprME5FZE1iRWhQTWs1VlRsaExUQXBrVnpoaGMzcE5aRWRUVGpaMlQzWlpLMmc1VlZWcVdXWnZNaTkyVURWQllsWmFSM0UzZVZWVFozQkpOVGx0VTFocFVUWnVVazVKZURCTk9DOTJPRlE0Q2tOTE1GSkVXVTUzV0ZaQlVtRjJUR2hWVnpaTllYSnVVRFI2VUhCMlJYUkRRbEp2T1hWeU1UbHRTRkZJZFVkSlVtODFhMUpKZDNZM1QzZGFObHByUm5nS2FFTktOblpaVFZaRmEzWm1NR1o0VW5BNVpuWkVWV2s1U2tkS1NrWnZTRkJZZERZeE5uRkdibEZOWkRsaFNsUjNZVTVUY0RGcVRVTXJiVEZzVFdaNFVBcEdTV1ZhZG5SS2NtZHBSR05LVFV3d2NIaHpRMEYzUlVGQllVNWFUVVpqZDBSbldVUldVakJRUVZGSUwwSkJVVVJCWjB0clRVRTRSMEV4VldSRmQwVkNDaTkzVVVaTlFVMUNRV1k0ZDBoUldVUldVakJQUWtKWlJVWk9ka3RFVlVsTVVHcEJTa3N4TVhWeFNXTnpibEJVYlVwUGFFRk5RbFZIUVRGVlpFVlJVVThLVFVGNVEwTnRkREZaYlZaNVltMVdNRnBZVFhkRVVWbEtTMjlhU1doMlkwNUJVVVZNUWxGQlJHZG5SVUpCUmtwd2JFUm9ibEZUVTBVeFRXOTVRemhHWndwVk1uTTRhVEpDZHpsUFlrdFhhMWROUTNjemFsTlhNVU5CVG5oMlZtZFZiVlYxY0dKM1preERibEkzZG1keVFXRkVOeTlsVXpNNVNqQkxTa3cxUmpKMUNqbHFiSFJ0VUZKdVFrTmtXSFZPVERVM2Vqa3pNREFyVUU5MVZXTXpWVVZRYWtWbVVUQlBSRmwyWldOeWREVnJiRWRZVGpGMk1GZzFlV04zZEd4U1psZ0tPR2x1WlhoQmNHd3hTRmM0YWtreFFXazVla3M0WjB4RFFrdHNlVzFKTmxaTVFubzFaSFZYTTI1RmFIZElXVzVFYlZwTVltbFVTMFkxUmpWaU1tSlRkUXBpZVhkaVluQkRabUZoVEdOR2JVNHpkVUZUZFZGemNrNXhSVlJOZVdsQ2JqRTFlV05xV1RCc1MxTmpOVmwxTTI5TVZ6WnRhbE5DZG0xVGJrNUtZV2Q2Q2tvcmFHeDFjVzluUW1KcVlUZHRjRnBaWkVWdFUzaFlTRk5zVEVZM1NXVktXalpaYTJkVlZsYzBkbFZ5TlZGNmF6RkZWWFJNV0ZsNFpURXpURWxEWm0wS1FteHZQUW90TFMwdExVVk9SQ0JEUlZKVVNVWkpRMEZVUlMwdExTMHRDZz09CiAgICBzZXJ2ZXI6IGh0dHBzOi8vMTkyLjE2OC4xLjIzNTo2NDQzCiAgbmFtZTogY2x1c3Rlci5sb2NhbApjb250ZXh0czoKLSBjb250ZXh0OgogICAgY2x1c3RlcjogY2x1c3Rlci5sb2NhbAogICAgdXNlcjoga3ViZXJuZXRlcy1hZG1pbgogIG5hbWU6IGt1YmVybmV0ZXMtYWRtaW5AY2x1c3Rlci5sb2NhbApjdXJyZW50LWNvbnRleHQ6IGt1YmVybmV0ZXMtYWRtaW5AY2x1c3Rlci5sb2NhbApraW5kOiBDb25maWcKcHJlZmVyZW5jZXM6IHt9CnVzZXJzOgotIG5hbWU6IGt1YmVybmV0ZXMtYWRtaW4KICB1c2VyOgogICAgY2xpZW50LWNlcnRpZmljYXRlLWRhdGE6IExTMHRMUzFDUlVkSlRpQkRSVkpVU1VaSlEwRlVSUzB0TFMwdENrMUpTVVJKVkVORFFXZHRaMEYzU1VKQlowbEpUbXRZZWxoSlYzaHVaRWwzUkZGWlNrdHZXa2xvZG1OT1FWRkZURUpSUVhkR1ZFVlVUVUpGUjBFeFZVVUtRWGhOUzJFelZtbGFXRXAxV2xoU2JHTjZRV1ZHZHpCNVRXcEZkMDFVVVhkUFJFazBUWHBHWVVaM01IbE9SRVYzVFZSVmQwMXFTWGxPVkZaaFRVUlJlQXBHZWtGV1FtZE9Wa0pCYjFSRWJrNDFZek5TYkdKVWNIUlpXRTR3V2xoS2VrMVNhM2RHZDFsRVZsRlJSRVY0UW5Ka1YwcHNZMjAxYkdSSFZucE1WMFpyQ21KWGJIVk5TVWxDU1dwQlRrSm5hM0ZvYTJsSE9YY3dRa0ZSUlVaQlFVOURRVkU0UVUxSlNVSkRaMHREUVZGRlFYSnFPR1JqTTIwd1dIUlZXSEpxYTNBS01XSmlZbloxV2t4U1dqZGFaRXhKUlZSM1UwWnNhVGt6ZDNrNWVEbHlWVVZPUzNwUmVFeDFNMDh2UlhCbWFFZFlOVlpuUzJZd2QzZHZhRlZ2Wm1GQldBcExVbkU1YTNSMk5VRllObmhTYVZwMk5uSlhkbGRaZDIxVVVteGpPVzkyWlhVclIwaFVlbFZSY2xObWFsbzRWRGsyTUUwcloxZDVhazVSTlU5c1F6TTBDbTk0UWpaalJrVk5abkpMY1VGVk0wRjVSMk41VlhJemJqTXdlbFpSWWtkM1ZGVjFjMHREZDJGT1owNXhjV3h3U25oa1NITmFNazU2VDIxaFZUZG9aalFLVDI0eFJqUkpPV1JwTDJOVlRuUldWWEZsV1VFNGNWSlJiVWxyWlVneGNIZEtXRlJNVGxOSGVIbFFUVkJwUWpGWGJqRkJSREk0VG05cmVUQjFRbFpGYXdwMU4yUmtkeTgxVXpOWVVUTkJibmt3ZFNzdmMwWmFkVUZDUzAxWE1WTklUVzVLY0hadlVuRjNXbkZKYUVsSGQxSktNMWRoVTFoUFUzRldjR1V6VEhOV0NrZ3lVR0kyVVVsRVFWRkJRbTh4V1hkV1JFRlBRbWRPVmtoUk9FSkJaamhGUWtGTlEwSmhRWGRGZDFsRVZsSXdiRUpCZDNkRFoxbEpTM2RaUWtKUlZVZ0tRWGRKZDBSQldVUldVakJVUVZGSUwwSkJTWGRCUkVGbVFtZE9Wa2hUVFVWSFJFRlhaMEpVWW5sbk1VTkRlalIzUTFOMFpHSnhhVWhNU25vd05XbFVid3BSUkVGT1FtZHJjV2hyYVVjNWR6QkNRVkZ6UmtGQlQwTkJVVVZCV1hrM1puTkdTbXRoVVdOVWRXRmFlV1ExY1hsWlVHOUpMMkZ0YVd3M09EWk1WbWxGQ21scWMwVjVjbkJNV0ZsV2JrZDNlaTlsVWtGdlMySmpZWGN3UlZWVmFEUnlNV1UwV2pCMVluTnJVMGgxVlhaTVYweGlSazR5ZG1SYVlWWmhaVVIzZW04S1FWbFJkVGRwVWxkbE9YSndUVzF4VFZwalZISnJPRU0xY1hsVk9VMWtWMjVDUWpSalVEVk5jREZLV1ZWdE9EUkJRbGhrTkN0VFNXMVlWamRNVnpreVJnbzVRa3A2Y2xCYWNUWmxTbGR5SzBNcllYTXhZbXRqZFUxVlltbHVlRFpPVEVKeFRscE9TVkZqT0RsSVQzRXhPVWh0UVdvelQxaG5SRzFPY0RCRE5rbGhDbTFLWkRGcmNVNHhSelJYZG5OUWFWcDRZMGRDZGxkNlowSjVObk5ZTkRjd2VFcG5Zak5JVXpKaE1qTlVZbFEzUTFaS2VHWjNabEJhV0c0M09WUTBhR0lLZDFrMmVrVjVibVJHVjFCelYxQklhbE42VUZaNlRtaFJTazFNTjJ4SWRXeDVZbHBQVUdZNFNEUndibkJMZUdSeVRVRTlQUW90TFMwdExVVk9SQ0JEUlZKVVNVWkpRMEZVUlMwdExTMHRDZz09CiAgICBjbGllbnQta2V5LWRhdGE6IExTMHRMUzFDUlVkSlRpQlNVMEVnVUZKSlZrRlVSU0JMUlZrdExTMHRMUXBOU1VsRmNFRkpRa0ZCUzBOQlVVVkJjbW80WkdNemJUQllkRlZZY21wcmNERmlZbUoyZFZwTVVsbzNXbVJNU1VWVWQxTkdiR2s1TTNkNU9YZzVjbFZGQ2s1TGVsRjRUSFV6VHk5RmNHWm9SMWcxVm1kTFpqQjNkMjlvVlc5bVlVRllTMUp4T1d0MGRqVkJXRFo0VW1sYWRqWnlWM1pYV1hkdFZGSnNZemx2ZG1VS2RTdEhTRlI2VlZGeVUyWnFXamhVT1RZd1RTdG5WM2xxVGxFMVQyeERNelJ2ZUVJMlkwWkZUV1p5UzNGQlZUTkJlVWRqZVZWeU0yNHpNSHBXVVdKSGR3cFVWWFZ6UzBOM1lVNW5UbkZ4YkhCS2VHUkljMW95VG5wUGJXRlZOMmhtTkU5dU1VWTBTVGxrYVM5alZVNTBWbFZ4WlZsQk9IRlNVVzFKYTJWSU1YQjNDa3BZVkV4T1UwZDRlVkJOVUdsQ01WZHVNVUZFTWpoT2IydDVNSFZDVmtWcmRUZGtaSGN2TlZNeldGRXpRVzU1TUhVckwzTkdXblZCUWt0TlZ6RlRTRTBLYmtwd2RtOVNjWGRhY1Vsb1NVZDNVa296VjJGVFdFOVRjVlp3WlROTWMxWklNbEJpTmxGSlJFRlJRVUpCYjBsQ1FWRkRiSEZuU1hoUFQxRkNVMkUxUkFwRFluYzFiMkZ2V2xCT1JWSTVlVFJsV1dWWWQzcHZZa2gyU1dWeUwydzNiWGhWUjJwYWVUZDROMDV6VVZaWlFYbHBWREpYV1c1a1VXZHFjVEo2TVVRMENqVTBNRGx0Ykhack1XUnNVSG8wYkhndlltUnZUM0ZpYkdnelkyVXhSamx5VmtvMVIyMVBlbEp3VFRCbVNrRTFNRXRZYlZaQ1VrUllZMnhrVm1GVE0xTUtaV3RoY20xck5HVnVVMEUxUlZaeVN6bEpZVEozYXpZMVJtazNkbEZKWW1jMGNWZ3dNVVJwUjFvMGNtOW9jVEJMY0RsT05reHRZWGgxTUM5RFRHTjBWUXBoZGsxck1HWkRiVkYzYjBKRFZIQXlSRFZPUlhKb09VSTBWM2RHYVd4S2EzVkNSaXRpT1ZwVGNGY3ZPVmw1T1VoWU9IaEdibkIwUVZOQk1reERjakExQ210VVNtSllaakoyUW1SemVUY3paSEpWT0ZCNE9TdGhZV1F4UW1GclZteHRiak5tY0hkb2MzRTNjRFZUVDFORlRYZDVjbFZVWTNGVGRrY3hiMDlKTkZNS2FqaFFXbWRNWmxKQmIwZENRVTVMZUZkTlIwOHpSVEF2VEhGNk0ya3lWMGhhWVhKS1JDOUJVV0pOVkZkMVRHWmFTemcwVlVoWVozY3dSM0JrZURkMGFBbzBWalZUUmpOaU5sRktSVW92V21KSmVXSkNjbFl2UzJ4MlZVUkZSbWhDVjFWcVpTOU1VaXN4YjFOeGJIYzVaVTVuWjFOUWJubHlSVGsxWVRoTVpHeGtDbVV5YVZWMVIyUnJZV2RITlVab2MzbFJXUzlOTWpJNVRqZHZVVk52VVVrdmQxQkhTelpRTHpaVFpHdHBVbk5ISzNCUk5IQTVUMWxPUVc5SFFrRk9Uek1LV25KS2IxcEtaWGhKUTI1T1VXMUNaRzVDTkRkMmVIY3pjV2xOUmxseVNVeE5hMmd5ZFZwUVkyOTVUbFpHYjBWMlZsUlVVMGhPT1RSS1NGQklXRmN4UlFvMlkxZDRNVk5RY1RCcE5qUlVjelJwTVVkMGVUbDBhMWcwYkVKQ1YxSXlORXRPSzFCRVJFOHpSWHBqT0ZOVEwxbzVOM1JOYUhaNlpYVlpWVzlMYW01S0NsWnBPRXM1VjBodFIxaG9VQ3QyUnk4MmVFMXZSVGg1YlUxamQyeEhOMkozWkhnMWRrWk9TazVCYjBkQlVWQmtUMVoxUTIxTVYzUXJRMUJsVEd4Q1RHSUtNVzR5U1ROSk1Ib3ZURE0wTVhwbGRuVnBkVnB4Y1ZocGJtVnRjek5MY1doM01rOXpkVXBOVW5SaFpFOHJiQ3RRVlZWaVNVbzFibFJqVmxWR1QwdFNiQXBXWVhOMFZITnVRMjFHVUd0Mk1rcDVOVTVWYTFSNGRrMHZSREp4U2xsM1pITllSM0ZMY21SaWRVbDRTblJNYTJGWWFYcGpkazFXWVRsdU5rbENlRzFDQ21SUWJGRlFlRE1yUWpKWU5sTXlUblJ2WVVKMVZUQkZRMmRaUWtSUmVFRm5aa05SUWxGWFpUZG5RbVZ1WWk5WlMyTlBZbVJsZUROV1pFZ3JVRzE0YTBZS2FIQnhZM3BGYzFWRVdrNVNlRmw2Ym1SQ01YbE1ZMUVySzBWaVNsVlZlVWd6TWtOamQxcDVNamxTTUhOU2EzRkJVRWt3UzBkYWJIWTNLMHd4UjNrek5RcEpTVkUyTldRek15OVlTWFV2Y1haRE1rdFNSMDFEYURKcmJsVm1NazFTUm5VNVEweHZjMUJUZDIwMGVWbGpkVFJWVmtwQ1FWVm1kVEpLWXl0bWNGVktDbTFVWW1aUVVVdENaMUZESzJGWFVERjNhMjQwY2paR1dETTFlQzk1Y2pCbmFGWm9lUzlEUkhaa2NsaHplR1Z5V1hCWFJqSTRWV3BMYVcwNWRrSTFObllLVWtOb01HbGFWbTVvU0dWcE1qSkdZakZOUnpkM1VrdHBWa2xUTUhCYVYySjJURXB5TldNMFkzVjBUekYxU1RaVkx5OXZVakZXT1hSUU1VSnhUWEJZTUFwbU1tUTRaa3hLUkhOb05YWXJkUzlEY0dKRVUxUmtNWFk0VTAxdGFtNVhSazkzTnpSR2RqUjZVRU4xWWxkM1FXYzFaV2RzTmtFOVBRb3RMUzB0TFVWT1JDQlNVMEVnVUZKSlZrRlVSU0JMUlZrdExTMHRMUW89Cg==
---
# Source: uyuni-suite/charts/mariadb/templates/primary/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: mariadb
  namespace: "release-5"
  labels:
    app.kubernetes.io/name: mariadb
    helm.sh/chart: mariadb-11.4.5
    app.kubernetes.io/instance: uyuni-suite
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/component: primary
data:
  my.cnf: |-
    [mysqld]
    skip-name-resolve
    explicit_defaults_for_timestamp
    basedir=/opt/bitnami/mariadb
    plugin_dir=/opt/bitnami/mariadb/plugin
    port=3306
    socket=/opt/bitnami/mariadb/tmp/mysql.sock
    tmpdir=/opt/bitnami/mariadb/tmp
    max_allowed_packet=16M
    bind-address=*
    pid-file=/opt/bitnami/mariadb/tmp/mysqld.pid
    log-error=/opt/bitnami/mariadb/logs/mysqld.log
    character-set-server=UTF8
    collation-server=utf8_general_ci
    slow_query_log=0
    slow_query_log_file=/opt/bitnami/mariadb/logs/mysqld.log
    long_query_time=10.0
    interactive_timeout=1803
    wait_timeout=1803
    
    [client]
    port=3306
    socket=/opt/bitnami/mariadb/tmp/mysql.sock
    default-character-set=UTF8
    plugin_dir=/opt/bitnami/mariadb/plugin
    
    [manager]
    port=3306
    socket=/opt/bitnami/mariadb/tmp/mysql.sock
    pid-file=/opt/bitnami/mariadb/tmp/mysqld.pid
---
# Source: uyuni-suite/templates/frontend-config.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: uyuni-suite-frontend-config
  namespace: release-5
data:
  nginx.conf: |-
    upstream uyuni-manager-core {
        server uyuni-suite-core:8080;
    }

    upstream uyuni-manager-noti {
        server uyuni-suite-noti:8080;
    }

    upstream uyuni-manager-batch {
        server uyuni-suite-batch:8080;
    }

    server {
        listen 80;
        location / {
            root    /app/build;
            index   index.html;
            try_files $uri $uri/ /index.html;
            proxy_read_timeout 21600;
            client_max_body_size 0;
        }

        location /api/v1/monitor {
            proxy_pass  http://uyuni-manager-core/api/v1/monitor;
        }

        location /api/v1/manager {
            proxy_pass  http://uyuni-manager-core/api/v1/manager;
            proxy_read_timeout 21600;
            client_max_body_size 0;
            proxy_request_buffering off;
        }

        location /api/v1/noti {
            proxy_pass  http://uyuni-manager-noti/api/v1/noti;
        }

        location /manager/ws {
            proxy_pass  http://uyuni-manager-core/manager/ws;
            proxy_http_version 1.1;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";
            proxy_set_header Host $host;
        }

        location /docs {
            proxy_pass  http://uyuni-manager-core/docs;
        }
    }
---
# Source: uyuni-suite/templates/mig-config.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: mig-config
  namespace: release-5
data:
  migProfile.json: |-
    {
      "migProfiles": [
        {
          "migProduct": "A100_40GB",
          "migInfos": [
            {
              "migProfile": "1g.5gb",
              "count": 7
            },
            {
              "migProfile": "2g.10gb",
              "count": 3
            },
            {
              "migProfile": "3g.20gb",
              "count": 2
            },
            {
              "migProfile": "4g.20gb",
              "count": 1
            },
            {
              "migProfile": "7g.40gb",
              "count": 1
            }
          ]
        },
        {
          "migProduct": "A100_80GB",
          "migInfos": [
            {
              "migProfile": "1g.10gb",
              "count": 7
            },
            {
              "migProfile": "2g.20gb",
              "count": 3
            },
            {
              "migProfile": "3g.40gb",
              "count": 2
            },
            {
              "migProfile": "4g.40gb",
              "count": 1
            },
            {
              "migProfile": "7g.80gb",
              "count": 1
            }
          ]
        },
        {
          "migProduct": "H100",
          "migInfos": [
            {
              "migProfile": "1g.10gb",
              "count": 7
            },
            {
              "migProfile": "2g.20gb",
              "count": 3
            },
            {
              "migProfile": "3g.40gb",
              "count": 2
            },
            {
              "migProfile": "4g.40gb",
              "count": 1
            },
            {
              "migProfile": "7g.80gb",
              "count": 1
            }
          ]
        },
        {
          "migProduct": "A30",
          "migInfos": [
            {
              "migProfile": "1g.6gb",
              "count": 4
            },
            {
              "migProfile": "2g.12gb",
              "count": 2
            },
            {
              "migProfile": "4g.24gb",
              "count": 1
            }
          ]
        }
      ]
    }
---
# Source: uyuni-suite/templates/pvc-core.yaml
kind: PersistentVolumeClaim
apiVersion: v1
metadata:
  name: "uyuni-pvc"
  namespace: release-5
  annotations:
    helm.sh/resource-policy: keep
  labels:
    helm.sh/chart: uyuni-suite-0.1.0
    app.kubernetes.io/name: uyuni-suite
    app.kubernetes.io/version: "1.16.0"
    app.kubernetes.io/managed-by: Helm
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 5Gi
---
# Source: uyuni-suite/templates/role.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: uyuni-role
  namespace: release-5
rules:
  - apiGroups: ["*"]
    resources: ["jobs", "statefulsets", "services", "daemonsets", "pods", "configmaps", "configmaps", "nodes", "ingresses"]
    verbs: ["*"]
---
# Source: uyuni-suite/templates/role-binding.yaml
kind: RoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: uyuni-role-binding
  namespace: release-5
subjects:
  - kind: ServiceAccount
    name: default
roleRef:
  kind: Role
  name: uyuni-role
  apiGroup: rbac.authorization.k8s.io
---
# Source: uyuni-suite/charts/mariadb/templates/primary/svc.yaml
apiVersion: v1
kind: Service
metadata:
  name: mariadb
  namespace: "release-5"
  labels:
    app.kubernetes.io/name: mariadb
    helm.sh/chart: mariadb-11.4.5
    app.kubernetes.io/instance: uyuni-suite
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/component: primary
  annotations:
spec:
  type: ClusterIP
  sessionAffinity: None
  ports:
    - name: mysql
      port: 3306
      protocol: TCP
      targetPort: mysql
      nodePort: null
  selector: 
    app.kubernetes.io/name: mariadb
    app.kubernetes.io/instance: uyuni-suite
    app.kubernetes.io/component: primary
---
# Source: uyuni-suite/templates/service-batch.yaml
apiVersion: v1
kind: Service
metadata:
  name: "uyuni-suite-batch"
  namespace: release-5
  labels:
    helm.sh/chart: uyuni-suite-0.1.0
    app.kubernetes.io/name: uyuni-suite
    app.kubernetes.io/version: "1.16.0"
    app.kubernetes.io/managed-by: Helm
spec:
  type: ClusterIP
  ports:
    - port: 8080
      targetPort: 8080
      protocol: TCP
      name: tomcat
  selector:
    app: uyuni-suite-batch
---
# Source: uyuni-suite/templates/service-core.yaml
apiVersion: v1
kind: Service
metadata:
  name: "uyuni-suite-core"
  namespace: release-5
  labels:
    helm.sh/chart: uyuni-suite-0.1.0
    app.kubernetes.io/name: uyuni-suite
    app.kubernetes.io/version: "1.16.0"
    app.kubernetes.io/managed-by: Helm
spec:
  type: ClusterIP
  ports:
    - port: 8080
      targetPort: 8080
      protocol: TCP
      name: tomcat
  selector:
    app: uyuni-manager-core
---
# Source: uyuni-suite/templates/service-frontend.yaml
apiVersion: v1
kind: Service
metadata:
  name: "uyuni-suite-frontend"
  namespace: release-5
  labels:
    helm.sh/chart: uyuni-suite-0.1.0
    app.kubernetes.io/name: uyuni-suite
    app.kubernetes.io/version: "1.16.0"
    app.kubernetes.io/managed-by: Helm
spec:
  type: NodePort
  ports:
    - port: 80
      targetPort: http
      protocol: TCP
      name: http
      nodePort: 30005
  selector:
    app: uyuni-suite-frontend
---
# Source: uyuni-suite/templates/service-noti.yaml
apiVersion: v1
kind: Service
metadata:
  name: "uyuni-suite-noti"
  namespace: release-5
  labels:
    helm.sh/chart: uyuni-suite-0.1.0
    app.kubernetes.io/name: uyuni-suite
    app.kubernetes.io/version: "1.16.0"
    app.kubernetes.io/managed-by: Helm
spec:
  type: ClusterIP
  ports:
    - port: 8080
      targetPort: 8080
      protocol: TCP
      name: tomcat
  selector:
    app: uyuni-suite-noti
---
# Source: uyuni-suite/templates/deployment-batch.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: "uyuni-suite-batch"
  namespace: release-5
  labels:
    helm.sh/chart: uyuni-suite-0.1.0
    app.kubernetes.io/name: uyuni-suite
    app.kubernetes.io/version: "1.16.0"
    app.kubernetes.io/managed-by: Helm
spec:
  replicas: 1
  selector:
    matchLabels:
      app: uyuni-suite-batch
  template:
    metadata:
      labels:
        app: uyuni-suite-batch
    spec:
      serviceAccountName: default
      securityContext:
        {}
      containers:
        - name: uyuni-suite
          securityContext:
            {}
          image: "xiilab/uyuni-manager-batch:0.5.41-stag"
          imagePullPolicy: IfNotPresent
          env:
            - name: SPRING_PROFILES_ACTIVE
              value: dev
            - name: K8S_NAMESPACE
              value: "release-5"
            - name: KEYCLOAK_REALM
              value: uyuni
            - name: KEYCLOAK_AUTHSERVERURL
              value: "http://211.218.247.34:30051/auth"
            - name: KEYCLOAK_RESOURCE
              value: uyuni
            - name: ADMIN_PASSWORD
              value: "xiilabPassword3#"
          ports:
            - name: tomcat
              containerPort: 8080
              protocol: TCP
          livenessProbe:
            httpGet:
              path: /actuator/health/liveness
              port: 8080
            initialDelaySeconds: 60
            periodSeconds: 15
          readinessProbe:
            httpGet:
              path: /actuator/health/readiness
              port: 8080
            initialDelaySeconds: 60
            periodSeconds: 10
          resources:
            {}
---
# Source: uyuni-suite/templates/deployment-core.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: uyuni-manager-core
  namespace: release-5
  labels:
    helm.sh/chart: uyuni-suite-0.1.0
    app.kubernetes.io/name: uyuni-suite
    app.kubernetes.io/version: "1.16.0"
    app.kubernetes.io/managed-by: Helm
spec:
  replicas: 1
  selector:
    matchLabels:
      app: uyuni-manager-core
  template:
    metadata:
      labels:
        app: uyuni-manager-core
    spec:
      serviceAccountName: default
      securityContext:
        {}
      containers:
        - name: uyuni-suite
          securityContext:
            {}
          image: "xiilab/uyuni-manager-core:0.5.41-stag"
          imagePullPolicy: IfNotPresent
          env:
            - name: mig-profile-path
              value: /root/migProfile/migProfile.json
            - name: SPRING_PROFILES_ACTIVE
              value: dev
            - name: KEYCLOAK_REALM
              value: uyuni
            - name: KEYCLOAK_AUTHSERVERURL
              value: "http://211.218.247.34:30051/auth"
            - name: KEYCLOAK_RESOURCE
              value: uyuni
            - name: ADMIN_PASSWORD
              value: "xiilabPassword3#"
            - name: K8S_NAMESPACE
              value: "release-5"
            - name: UYUNIHOST
              value: "uyuni-suite.xiilab.com"
            - name: ADMIN_INIT-PASSWORD
              value: uyuni
            - name: SLURM_AGENT_URL
              value: http://192.168.1.46:8082
          ports:
            - name: tomcat
              containerPort: 8080
              protocol: TCP
          livenessProbe:
            httpGet:
              path: /actuator/health/liveness
              port: 8080
            initialDelaySeconds: 60
            periodSeconds: 15
          readinessProbe:
            httpGet:
              path: /actuator/health/readiness
              port: 8080
            initialDelaySeconds: 60
            periodSeconds: 10
          resources:
            {}
          volumeMounts:
            - mountPath: "/root/.kube"
              name: kube-config
              readOnly: true
            - mountPath: "/root/uyuni"
              name: uyuni-pvc
            - mountPath: "/root/migProfile"
              name: mig-profile
      volumes:
        - name: mig-profile
          configMap:
            name: mig-config
        - name: kube-config
          secret:
            secretName: kube-config
        - name: uyuni-pvc
          persistentVolumeClaim:
            claimName: "uyuni-pvc"
---
# Source: uyuni-suite/templates/deployment-frontend.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: "uyuni-suite-frontend"
  namespace: release-5
  labels:
    helm.sh/chart: uyuni-suite-0.1.0
    app.kubernetes.io/name: uyuni-suite
    app.kubernetes.io/version: "1.16.0"
    app.kubernetes.io/managed-by: Helm
spec:
  replicas: 1
  selector:
    matchLabels:
      app: uyuni-suite-frontend
  template:
    metadata:
      labels:
        app: uyuni-suite-frontend
    spec:
      serviceAccountName: default
      securityContext:
        {}
      containers:
        - name: uyuni-suite
          securityContext:
            {}
          image: "xiilab/uyuni-suite-frontend:0.5.21-stag"
          imagePullPolicy: IfNotPresent
          env:
            - name: REACT_APP_KEYCLOAK_REALM
              value: uyuni
            - name: REACT_APP_KEYCLOAK_CLIENT_ID
              value: uyuni
            - name: REACT_APP_KEYCLOAK_URL
              value: "http://211.218.247.34:30051/auth"
          ports:
            - name: http
              containerPort: 80
              protocol: TCP
          livenessProbe:
            httpGet:
              path: /
              port: http
          readinessProbe:
            httpGet:
              path: /
              port: http
          resources:
            {}
          volumeMounts:
            - name: nginx-config
              mountPath: /etc/nginx/conf.d
      volumes:
        - name: nginx-config
          configMap:
            name: uyuni-suite-frontend-config
---
# Source: uyuni-suite/templates/deployment-noti.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: "uyuni-suite-noti"
  namespace: release-5
  labels:
    helm.sh/chart: uyuni-suite-0.1.0
    app.kubernetes.io/name: uyuni-suite
    app.kubernetes.io/version: "1.16.0"
    app.kubernetes.io/managed-by: Helm
spec:
  replicas: 1
  selector:
    matchLabels:
      app: uyuni-suite-noti
  template:
    metadata:
      labels:
        app: uyuni-suite-noti
    spec:
      serviceAccountName: default
      securityContext:
        {}
      containers:
        - name: uyuni-suite
          securityContext:
            {}
          image: "xiilab/uyuni-manager-noti:0.5.41-stag"
          imagePullPolicy: IfNotPresent
          env:
            - name: SPRING_PROFILES_ACTIVE
              value: dev
            - name: SPRING_KAFKA_CONSUMER_BOOTSTRAP-SERVERS
              value: kafka-cp-kafka.kafka.svc:9092
            - name: SPRING_KAFKA_PRODUCER_BOOTSTRAP-SERVERS
              value: kafka-cp-kafka.kafka.svc:9092
          ports:
            - name: tomcat
              containerPort: 8080
              protocol: TCP
          livenessProbe:
            httpGet:
              path: /actuator/health/liveness
              port: 8080
            initialDelaySeconds: 60
            periodSeconds: 15
          readinessProbe:
            httpGet:
              path: /actuator/health/readiness
              port: 8080
            initialDelaySeconds: 60
            periodSeconds: 10
          resources:
            {}
---
# Source: uyuni-suite/charts/mariadb/templates/primary/statefulset.yaml
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: mariadb
  namespace: "release-5"
  labels:
    app.kubernetes.io/name: mariadb
    helm.sh/chart: mariadb-11.4.5
    app.kubernetes.io/instance: uyuni-suite
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/component: primary
spec:
  replicas: 1
  revisionHistoryLimit: 10
  selector:
    matchLabels: 
      app.kubernetes.io/name: mariadb
      app.kubernetes.io/instance: uyuni-suite
      app.kubernetes.io/component: primary
  serviceName: mariadb
  updateStrategy:
    type: RollingUpdate
  template:
    metadata:
      annotations:
        checksum/configuration: f759b324dc27719281cc3349a9a9046d255385cd03a07e51e1d65242aca32ddd
      labels:
        app.kubernetes.io/name: mariadb
        helm.sh/chart: mariadb-11.4.5
        app.kubernetes.io/instance: uyuni-suite
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/component: primary
    spec:
      
      serviceAccountName: mariadb
      affinity:
        podAffinity:
          
        podAntiAffinity:
          preferredDuringSchedulingIgnoredDuringExecution:
            - podAffinityTerm:
                labelSelector:
                  matchLabels:
                    app.kubernetes.io/name: mariadb
                    app.kubernetes.io/instance: uyuni-suite
                    app.kubernetes.io/component: primary
                topologyKey: kubernetes.io/hostname
              weight: 1
        nodeAffinity:
          
      securityContext:
        fsGroup: 1001
      containers:
        - name: mariadb
          image: docker.io/bitnami/mariadb:10.6.10-debian-11-r6
          imagePullPolicy: "IfNotPresent"
          securityContext:
            allowPrivilegeEscalation: false
            privileged: false
            runAsNonRoot: true
            runAsUser: 1001
          env:
            - name: BITNAMI_DEBUG
              value: "false"
            - name: MARIADB_ROOT_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: mariadb
                  key: mariadb-root-password
            - name: MARIADB_USER
              value: "uyuni"
            - name: MARIADB_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: mariadb
                  key: mariadb-password
            - name: MARIADB_DATABASE
              value: "uyuni"
          ports:
            - name: mysql
              containerPort: 3306
          livenessProbe:
            failureThreshold: 3
            initialDelaySeconds: 120
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 1
            exec:
              command:
                - /bin/bash
                - -ec
                - |
                  password_aux="${MARIADB_ROOT_PASSWORD:-}"
                  if [[ -f "${MARIADB_ROOT_PASSWORD_FILE:-}" ]]; then
                      password_aux=$(cat "$MARIADB_ROOT_PASSWORD_FILE")
                  fi
                  mysqladmin status -uroot -p"${password_aux}"
          readinessProbe:
            failureThreshold: 3
            initialDelaySeconds: 30
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 1
            exec:
              command:
                - /bin/bash
                - -ec
                - |
                  password_aux="${MARIADB_ROOT_PASSWORD:-}"
                  if [[ -f "${MARIADB_ROOT_PASSWORD_FILE:-}" ]]; then
                      password_aux=$(cat "$MARIADB_ROOT_PASSWORD_FILE")
                  fi
                  mysqladmin status -uroot -p"${password_aux}"
          resources: 
            limits: {}
            requests: {}
          volumeMounts:
            - name: data
              mountPath: /bitnami/mariadb
            - name: config
              mountPath: /opt/bitnami/mariadb/conf/my.cnf
              subPath: my.cnf
      volumes:
        - name: config
          configMap:
            name: mariadb
  volumeClaimTemplates:
    - metadata:
        name: data
        labels: 
          app.kubernetes.io/name: mariadb
          app.kubernetes.io/instance: uyuni-suite
          app.kubernetes.io/component: primary
      spec:
        accessModes:
          - "ReadWriteOnce"
        resources:
          requests:
            storage: "8Gi"

