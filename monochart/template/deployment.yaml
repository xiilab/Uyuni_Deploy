---
# Source: uyuni-suite/charts/mariadb/templates/serviceaccount.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: mariadb
  namespace: "release-4"
  labels:
    app.kubernetes.io/name: mariadb
    helm.sh/chart: mariadb-11.4.5
    app.kubernetes.io/instance: uyuni-suite
    app.kubernetes.io/managed-by: Helm
  annotations:
automountServiceAccountToken: false
---
# Source: uyuni-suite/charts/mariadb/templates/secrets.yaml
apiVersion: v1
kind: Secret
metadata:
  name: mariadb
  namespace: "release-4"
  labels:
    app.kubernetes.io/name: mariadb
    helm.sh/chart: mariadb-11.4.5
    app.kubernetes.io/instance: uyuni-suite
    app.kubernetes.io/managed-by: Helm
type: Opaque
data:
  mariadb-root-password: "cm9vdA=="
  mariadb-password: "dXl1bmlQYXNzd29yZDMj"
---
# Source: uyuni-suite/templates/kube-config-secret.yaml
apiVersion: v1
kind: Secret
metadata:
  name: kube-config
type: Opaque
data:
  config: |-
      YXBpVmVyc2lvbjogdjEKY2x1c3RlcnM6Ci0gY2x1c3RlcjoKICAgIGNlcnRpZmljYXRlLWF1dGhvcml0eS1kYXRhOiBMUzB0TFMxQ1JVZEpUaUJEUlZKVVNVWkpRMEZVUlMwdExTMHRDazFKU1VNdmFrTkRRV1ZoWjBGM1NVSkJaMGxDUVVSQlRrSm5hM0ZvYTJsSE9YY3dRa0ZSYzBaQlJFRldUVkpOZDBWUldVUldVVkZFUlhkd2NtUlhTbXdLWTIwMWJHUkhWbnBOUWpSWVJGUkplVTFVUVhoT1JFRTBUV3BuZWsxV2IxaEVWRTE1VFZSQmVFMVVRVFJOYW1kNlRWWnZkMFpVUlZSTlFrVkhRVEZWUlFwQmVFMUxZVE5XYVZwWVNuVmFXRkpzWTNwRFEwRlRTWGRFVVZsS1MyOWFTV2gyWTA1QlVVVkNRbEZCUkdkblJWQkJSRU5EUVZGdlEyZG5SVUpCU3pWMUNpOWtjVFpyZW1GRWJsQTVRMnhDWVdVcmJrRXlPRVJNVVZZNEx6WTRWRnBFWW1wdE4yb3ZTSEpTVXpnd1NXaEZTVGh4VW5ab1owRnVRVVpyT1dVeVpYZ0thbWRYVGt4SU1tOUVWVTl5UTFkbGFHZGpXVFpoU0UxT2JVMHdWalJpZEZsNGJXaHZWVlpYY3pkdlFVdGtPVzl4UXprME5FZE1iRWhQTWs1VlRsaExUQXBrVnpoaGMzcE5aRWRUVGpaMlQzWlpLMmc1VlZWcVdXWnZNaTkyVURWQllsWmFSM0UzZVZWVFozQkpOVGx0VTFocFVUWnVVazVKZURCTk9DOTJPRlE0Q2tOTE1GSkVXVTUzV0ZaQlVtRjJUR2hWVnpaTllYSnVVRFI2VUhCMlJYUkRRbEp2T1hWeU1UbHRTRkZJZFVkSlVtODFhMUpKZDNZM1QzZGFObHByUm5nS2FFTktOblpaVFZaRmEzWm1NR1o0VW5BNVpuWkVWV2s1U2tkS1NrWnZTRkJZZERZeE5uRkdibEZOWkRsaFNsUjNZVTVUY0RGcVRVTXJiVEZzVFdaNFVBcEdTV1ZhZG5SS2NtZHBSR05LVFV3d2NIaHpRMEYzUlVGQllVNWFUVVpqZDBSbldVUldVakJRUVZGSUwwSkJVVVJCWjB0clRVRTRSMEV4VldSRmQwVkNDaTkzVVVaTlFVMUNRV1k0ZDBoUldVUldVakJQUWtKWlJVWk9ka3RFVlVsTVVHcEJTa3N4TVhWeFNXTnpibEJVYlVwUGFFRk5RbFZIUVRGVlpFVlJVVThLVFVGNVEwTnRkREZaYlZaNVltMVdNRnBZVFhkRVVWbEtTMjlhU1doMlkwNUJVVVZNUWxGQlJHZG5SVUpCUmtwd2JFUm9ibEZUVTBVeFRXOTVRemhHWndwVk1uTTRhVEpDZHpsUFlrdFhhMWROUTNjemFsTlhNVU5CVG5oMlZtZFZiVlYxY0dKM1preERibEkzZG1keVFXRkVOeTlsVXpNNVNqQkxTa3cxUmpKMUNqbHFiSFJ0VUZKdVFrTmtXSFZPVERVM2Vqa3pNREFyVUU5MVZXTXpWVVZRYWtWbVVUQlBSRmwyWldOeWREVnJiRWRZVGpGMk1GZzFlV04zZEd4U1psZ0tPR2x1WlhoQmNHd3hTRmM0YWtreFFXazVla3M0WjB4RFFrdHNlVzFKTmxaTVFubzFaSFZYTTI1RmFIZElXVzVFYlZwTVltbFVTMFkxUmpWaU1tSlRkUXBpZVhkaVluQkRabUZoVEdOR2JVNHpkVUZUZFZGemNrNXhSVlJOZVdsQ2JqRTFlV05xV1RCc1MxTmpOVmwxTTI5TVZ6WnRhbE5DZG0xVGJrNUtZV2Q2Q2tvcmFHeDFjVzluUW1KcVlUZHRjRnBaWkVWdFUzaFlTRk5zVEVZM1NXVktXalpaYTJkVlZsYzBkbFZ5TlZGNmF6RkZWWFJNV0ZsNFpURXpURWxEWm0wS1FteHZQUW90TFMwdExVVk9SQ0JEUlZKVVNVWkpRMEZVUlMwdExTMHRDZz09CiAgICBzZXJ2ZXI6IGh0dHBzOi8vMTI3LjAuMC4xOjY0NDMKICBuYW1lOiBjbHVzdGVyLmxvY2FsCmNvbnRleHRzOgotIGNvbnRleHQ6CiAgICBjbHVzdGVyOiBjbHVzdGVyLmxvY2FsCiAgICB1c2VyOiBrdWJlcm5ldGVzLWFkbWluCiAgbmFtZToga3ViZXJuZXRlcy1hZG1pbkBjbHVzdGVyLmxvY2FsCmN1cnJlbnQtY29udGV4dDoga3ViZXJuZXRlcy1hZG1pbkBjbHVzdGVyLmxvY2FsCmtpbmQ6IENvbmZpZwpwcmVmZXJlbmNlczoge30KdXNlcnM6Ci0gbmFtZToga3ViZXJuZXRlcy1hZG1pbgogIHVzZXI6CiAgICBjbGllbnQtY2VydGlmaWNhdGUtZGF0YTogTFMwdExTMUNSVWRKVGlCRFJWSlVTVVpKUTBGVVJTMHRMUzB0Q2sxSlNVUkpWRU5EUVdkdFowRjNTVUpCWjBsSlRtdFllbGhKVjNodVpFbDNSRkZaU2t0dldrbG9kbU5PUVZGRlRFSlJRWGRHVkVWVVRVSkZSMEV4VlVVS1FYaE5TMkV6Vm1sYVdFcDFXbGhTYkdONlFXVkdkekI1VFdwRmQwMVVVWGRQUkVrMFRYcEdZVVozTUhsT1JFVjNUVlJWZDAxcVNYbE9WRlpoVFVSUmVBcEdla0ZXUW1kT1ZrSkJiMVJFYms0MVl6TlNiR0pVY0hSWldFNHdXbGhLZWsxU2EzZEdkMWxFVmxGUlJFVjRRbkprVjBwc1kyMDFiR1JIVm5wTVYwWnJDbUpYYkhWTlNVbENTV3BCVGtKbmEzRm9hMmxIT1hjd1FrRlJSVVpCUVU5RFFWRTRRVTFKU1VKRFowdERRVkZGUVhKcU9HUmpNMjB3V0hSVldISnFhM0FLTVdKaVluWjFXa3hTV2pkYVpFeEpSVlIzVTBac2FUa3pkM2s1ZURseVZVVk9TM3BSZUV4MU0wOHZSWEJtYUVkWU5WWm5TMll3ZDNkdmFGVnZabUZCV0FwTFVuRTVhM1IyTlVGWU5uaFNhVnAyTm5KWGRsZFpkMjFVVW14ak9XOTJaWFVyUjBoVWVsVlJjbE5tYWxvNFZEazJNRTByWjFkNWFrNVJOVTlzUXpNMENtOTRRalpqUmtWTlpuSkxjVUZWTTBGNVIyTjVWWEl6YmpNd2VsWlJZa2QzVkZWMWMwdERkMkZPWjA1eGNXeHdTbmhrU0hOYU1rNTZUMjFoVlRkb1pqUUtUMjR4UmpSSk9XUnBMMk5WVG5SV1ZYRmxXVUU0Y1ZKUmJVbHJaVWd4Y0hkS1dGUk1UbE5IZUhsUVRWQnBRakZYYmpGQlJESTRUbTlyZVRCMVFsWkZhd3AxTjJSa2R5ODFVek5ZVVROQmJua3dkU3N2YzBaYWRVRkNTMDFYTVZOSVRXNUtjSFp2VW5GM1duRkphRWxIZDFKS00xZGhVMWhQVTNGV2NHVXpUSE5XQ2tneVVHSTJVVWxFUVZGQlFtOHhXWGRXUkVGUFFtZE9Wa2hST0VKQlpqaEZRa0ZOUTBKaFFYZEZkMWxFVmxJd2JFSkJkM2REWjFsSlMzZFpRa0pSVlVnS1FYZEpkMFJCV1VSV1VqQlVRVkZJTDBKQlNYZEJSRUZtUW1kT1ZraFRUVVZIUkVGWFowSlVZbmxuTVVORGVqUjNRMU4wWkdKeGFVaE1Tbm93TldsVWJ3cFJSRUZPUW1kcmNXaHJhVWM1ZHpCQ1FWRnpSa0ZCVDBOQlVVVkJXWGszWm5OR1NtdGhVV05VZFdGYWVXUTFjWGxaVUc5SkwyRnRhV3czT0RaTVZtbEZDbWxxYzBWNWNuQk1XRmxXYmtkM2VpOWxVa0Z2UzJKallYY3dSVlZWYURSeU1XVTBXakIxWW5OclUwaDFWWFpNVjB4aVJrNHlkbVJhWVZaaFpVUjNlbThLUVZsUmRUZHBVbGRsT1hKd1RXMXhUVnBqVkhKck9FTTFjWGxWT1Uxa1YyNUNRalJqVURWTmNERktXVlZ0T0RSQlFsaGtOQ3RUU1cxWVZqZE1Wemt5UmdvNVFrcDZjbEJhY1RabFNsZHlLME1yWVhNeFltdGpkVTFWWW1sdWVEWk9URUp4VGxwT1NWRmpPRGxJVDNFeE9VaHRRV296VDFoblJHMU9jREJETmtsaENtMUtaREZyY1U0eFJ6Ulhkbk5RYVZwNFkwZENkbGQ2WjBKNU5uTllORGN3ZUVwbllqTklVekpoTWpOVVlsUTNRMVpLZUdaM1psQmFXRzQzT1ZRMGFHSUtkMWsyZWtWNWJtUkdWMUJ6VjFCSWFsTjZVRlo2VG1oUlNrMU1OMnhJZFd4NVlscFBVR1k0U0RSd2JuQkxlR1J5VFVFOVBRb3RMUzB0TFVWT1JDQkRSVkpVU1VaSlEwRlVSUzB0TFMwdENnPT0KICAgIGNsaWVudC1rZXktZGF0YTogTFMwdExTMUNSVWRKVGlCU1UwRWdVRkpKVmtGVVJTQkxSVmt0TFMwdExRcE5TVWxGY0VGSlFrRkJTME5CVVVWQmNtbzRaR016YlRCWWRGVlljbXByY0RGaVltSjJkVnBNVWxvM1dtUk1TVVZVZDFOR2JHazVNM2Q1T1hnNWNsVkZDazVMZWxGNFRIVXpUeTlGY0dab1IxZzFWbWRMWmpCM2QyOW9WVzltWVVGWVMxSnhPV3QwZGpWQldEWjRVbWxhZGpaeVYzWlhXWGR0VkZKc1l6bHZkbVVLZFN0SFNGUjZWVkZ5VTJacVdqaFVPVFl3VFN0blYzbHFUbEUxVDJ4RE16UnZlRUkyWTBaRlRXWnlTM0ZCVlROQmVVZGplVlZ5TTI0ek1IcFdVV0pIZHdwVVZYVnpTME4zWVU1blRuRnhiSEJLZUdSSWMxb3lUbnBQYldGVk4yaG1ORTl1TVVZMFNUbGthUzlqVlU1MFZsVnhaVmxCT0hGU1VXMUphMlZJTVhCM0NrcFlWRXhPVTBkNGVWQk5VR2xDTVZkdU1VRkVNamhPYjJ0NU1IVkNWa1ZyZFRka1pIY3ZOVk16V0ZFelFXNTVNSFVyTDNOR1duVkJRa3ROVnpGVFNFMEtia3B3ZG05U2NYZGFjVWxvU1VkM1Vrb3pWMkZUV0U5VGNWWndaVE5NYzFaSU1sQmlObEZKUkVGUlFVSkJiMGxDUVZGRGJIRm5TWGhQVDFGQ1UyRTFSQXBEWW5jMWIyRnZXbEJPUlZJNWVUUmxXV1ZZZDNwdllraDJTV1Z5TDJ3M2JYaFZSMnBhZVRkNE4wNXpVVlpaUVhscFZESlhXVzVrVVdkcWNUSjZNVVEwQ2pVME1EbHRiSFpyTVdSc1VIbzBiSGd2WW1SdlQzRmliR2d6WTJVeFJqbHlWa28xUjIxUGVsSndUVEJtU2tFMU1FdFliVlpDVWtSWVkyeGtWbUZUTTFNS1pXdGhjbTFyTkdWdVUwRTFSVlp5U3psSllUSjNhelkxUm1rM2RsRkpZbWMwY1Znd01VUnBSMW8wY205b2NUQkxjRGxPTmt4dFlYaDFNQzlEVEdOMFZRcGhkazFyTUdaRGJWRjNiMEpEVkhBeVJEVk9SWEpvT1VJMFYzZEdhV3hLYTNWQ1JpdGlPVnBUY0Zjdk9WbDVPVWhZT0hoR2JuQjBRVk5CTWt4RGNqQTFDbXRVU21KWVpqSjJRbVJ6ZVRjelpISlZPRkI0T1N0aFlXUXhRbUZyVm14dGJqTm1jSGRvYzNFM2NEVlRUMU5GVFhkNWNsVlVZM0ZUZGtjeGIwOUpORk1LYWpoUVdtZE1abEpCYjBkQ1FVNUxlRmROUjA4elJUQXZUSEY2TTJreVYwaGFZWEpLUkM5QlVXSk5WRmQxVEdaYVN6ZzBWVWhZWjNjd1IzQmtlRGQwYUFvMFZqVlRSak5pTmxGS1JVb3ZXbUpKZVdKQ2NsWXZTMngyVlVSRlJtaENWMVZxWlM5TVVpc3hiMU54YkhjNVpVNW5aMU5RYm5seVJUazFZVGhNWkd4a0NtVXlhVlYxUjJScllXZEhOVVpvYzNsUldTOU5Nakk1VGpkdlVWTnZVVWt2ZDFCSFN6WlFMelpUWkd0cFVuTkhLM0JSTkhBNVQxbE9RVzlIUWtGT1R6TUtXbkpLYjFwS1pYaEpRMjVPVVcxQ1pHNUNORGQyZUhjemNXbE5SbGx5U1V4TmEyZ3lkVnBRWTI5NVRsWkdiMFYyVmxSVVUwaE9PVFJLU0ZCSVdGY3hSUW8yWTFkNE1WTlFjVEJwTmpSVWN6UnBNVWQwZVRsMGExZzBiRUpDVjFJeU5FdE9LMUJFUkU4elJYcGpPRk5UTDFvNU4zUk5hSFo2WlhWWlZXOUxhbTVLQ2xacE9FczVWMGh0UjFob1VDdDJSeTgyZUUxdlJUaDViVTFqZDJ4SE4ySjNaSGcxZGtaT1NrNUJiMGRCVVZCa1QxWjFRMjFNVjNRclExQmxUR3hDVEdJS01XNHlTVE5KTUhvdlRETTBNWHBsZG5WcGRWcHhjVmhwYm1WdGN6TkxjV2gzTWs5emRVcE5VblJoWkU4cmJDdFFWVlZpU1VvMWJsUmpWbFZHVDB0U2JBcFdZWE4wVkhOdVEyMUdVR3QyTWtwNU5VNVZhMVI0ZGswdlJESnhTbGwzWkhOWVIzRkxjbVJpZFVsNFNuUk1hMkZZYVhwamRrMVdZVGx1TmtsQ2VHMUNDbVJRYkZGUWVETXJRakpZTmxNeVRuUnZZVUoxVlRCRlEyZFpRa1JSZUVGblprTlJRbEZYWlRkblFtVnVZaTlaUzJOUFltUmxlRE5XWkVnclVHMTRhMFlLYUhCeFkzcEZjMVZFV2s1U2VGbDZibVJDTVhsTVkxRXJLMFZpU2xWVmVVZ3pNa05qZDFwNU1qbFNNSE5TYTNGQlVFa3dTMGRhYkhZM0swd3hSM2t6TlFwSlNWRTJOV1F6TXk5WVNYVXZjWFpETWt0U1IwMURhREpyYmxWbU1rMVNSblU1UTB4dmMxQlRkMjAwZVZsamRUUlZWa3BDUVZWbWRUSktZeXRtY0ZWS0NtMVVZbVpRVVV0Q1oxRkRLMkZYVURGM2EyNDBjalpHV0RNMWVDOTVjakJuYUZab2VTOURSSFprY2xoemVHVnlXWEJYUmpJNFZXcExhVzA1ZGtJMU5uWUtVa05vTUdsYVZtNW9TR1ZwTWpKR1lqRk5SemQzVWt0cFZrbFRNSEJhVjJKMlRFcHlOV00wWTNWMFR6RjFTVFpWTHk5dlVqRldPWFJRTVVKeFRYQllNQXBtTW1RNFpreEtSSE5vTlhZcmRTOURjR0pFVTFSa01YWTRVMDF0YW01WFJrOTNOelJHZGpSNlVFTjFZbGQzUVdjMVpXZHNOa0U5UFFvdExTMHRMVVZPUkNCU1UwRWdVRkpKVmtGVVJTQkxSVmt0TFMwdExRbz0K
---
# Source: uyuni-suite/charts/mariadb/templates/primary/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: mariadb
  namespace: "release-4"
  labels:
    app.kubernetes.io/name: mariadb
    helm.sh/chart: mariadb-11.4.5
    app.kubernetes.io/instance: uyuni-suite
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/component: primary
data:
  my.cnf: |-
    [mysqld]
    skip-name-resolve
    explicit_defaults_for_timestamp
    basedir=/opt/bitnami/mariadb
    plugin_dir=/opt/bitnami/mariadb/plugin
    port=3306
    socket=/opt/bitnami/mariadb/tmp/mysql.sock
    tmpdir=/opt/bitnami/mariadb/tmp
    max_allowed_packet=16M
    bind-address=*
    pid-file=/opt/bitnami/mariadb/tmp/mysqld.pid
    log-error=/opt/bitnami/mariadb/logs/mysqld.log
    character-set-server=UTF8
    collation-server=utf8_general_ci
    slow_query_log=0
    slow_query_log_file=/opt/bitnami/mariadb/logs/mysqld.log
    long_query_time=10.0
    interactive_timeout=1803
    wait_timeout=1803
    
    [client]
    port=3306
    socket=/opt/bitnami/mariadb/tmp/mysql.sock
    default-character-set=UTF8
    plugin_dir=/opt/bitnami/mariadb/plugin
    
    [manager]
    port=3306
    socket=/opt/bitnami/mariadb/tmp/mysql.sock
    pid-file=/opt/bitnami/mariadb/tmp/mysqld.pid
---
# Source: uyuni-suite/templates/frontend-config.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: uyuni-suite-frontend-config
data:
  nginx.conf: |-
    upstream uyuni-manager-core {
        server uyuni-suite-core:8080;
    }

    upstream uyuni-manager-noti {
        server uyuni-suite-noti:8080;
    }

    upstream uyuni-manager-batch {
        server uyuni-suite-batch:8080;
    }

    server {        
        listen 80;
        
        location / {
            root    /app/build;
            index   index.html;
            try_files $uri $uri/ /index.html;
            client_max_body_size 0;
        }

        location /api/v1/monitor {
            proxy_pass  http://uyuni-manager-core/api/v1/monitor;
        }

        location /api/v1/manager {
            proxy_pass  http://uyuni-manager-core/api/v1/manager;
            proxy_read_timeout 21600;
            client_max_body_size 0;
        }

        location /api/v1/noti {
            proxy_pass  http://uyuni-manager-noti/api/v1/noti;
        }

        location /manager/ws {
            proxy_pass  http://uyuni-manager-core/manager/ws;
            proxy_http_version 1.1;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";
            proxy_set_header Host $host;
        }

        location /docs {
            proxy_pass  http://uyuni-manager-core/docs;
        }
    }
---
# Source: uyuni-suite/templates/mig-config.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: mig-config
data:
  migProfile.json: |-
    {
      "migProfiles": [
        {
          "migProduct": "A100_40GB",
          "migInfos": [
            {
              "migProfile": "1g.5gb",
              "count": 7
            },
            {
              "migProfile": "2g.10gb",
              "count": 3
            },
            {
              "migProfile": "3g.20gb",
              "count": 2
            },
            {
              "migProfile": "4g.20gb",
              "count": 1
            },
            {
              "migProfile": "7g.40gb",
              "count": 1
            }
          ]
        },
        {
          "migProduct": "A100_80GB",
          "migInfos": [
            {
              "migProfile": "1g.10gb",
              "count": 7
            },
            {
              "migProfile": "2g.20gb",
              "count": 3
            },
            {
              "migProfile": "3g.40gb",
              "count": 2
            },
            {
              "migProfile": "4g.40gb",
              "count": 1
            },
            {
              "migProfile": "7g.80gb",
              "count": 1
            }
          ]
        },
        {
          "migProduct": "H100",
          "migInfos": [
            {
              "migProfile": "1g.10gb",
              "count": 7
            },
            {
              "migProfile": "2g.20gb",
              "count": 3
            },
            {
              "migProfile": "3g.40gb",
              "count": 2
            },
            {
              "migProfile": "4g.40gb",
              "count": 1
            },
            {
              "migProfile": "7g.80gb",
              "count": 1
            }
          ]
        },
        {
          "migProduct": "A30",
          "migInfos": [
            {
              "migProfile": "1g.6gb",
              "count": 4
            },
            {
              "migProfile": "2g.12gb",
              "count": 2
            },
            {
              "migProfile": "4g.24gb",
              "count": 1
            }
          ]
        }
      ]
    }
---
# Source: uyuni-suite/templates/pvc-core.yaml
kind: PersistentVolumeClaim
apiVersion: v1
metadata:
  name: "uyuni-pvc"
  annotations:
    helm.sh/resource-policy: keep
  labels:
    helm.sh/chart: uyuni-suite-0.1.0
    app.kubernetes.io/name: uyuni-suite
    app.kubernetes.io/version: "1.16.0"
    app.kubernetes.io/managed-by: Helm
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 5Gi
---
# Source: uyuni-suite/templates/role.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: uyuni-role
rules:
  - apiGroups: ["*"]
    resources: ["jobs", "statefulsets", "services", "daemonsets", "pods", "configmaps", "configmaps", "nodes", "ingresses"]
    verbs: ["*"]
---
# Source: uyuni-suite/templates/role-binding.yaml
kind: RoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: uyuni-role-binding
subjects:
  - kind: ServiceAccount
    name: default
roleRef:
  kind: Role
  name: uyuni-role
  apiGroup: rbac.authorization.k8s.io
---
# Source: uyuni-suite/charts/mariadb/templates/primary/svc.yaml
apiVersion: v1
kind: Service
metadata:
  name: mariadb
  namespace: "release-4"
  labels:
    app.kubernetes.io/name: mariadb
    helm.sh/chart: mariadb-11.4.5
    app.kubernetes.io/instance: uyuni-suite
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/component: primary
  annotations:
spec:
  type: ClusterIP
  sessionAffinity: None
  ports:
    - name: mysql
      port: 3306
      protocol: TCP
      targetPort: mysql
      nodePort: null
  selector: 
    app.kubernetes.io/name: mariadb
    app.kubernetes.io/instance: uyuni-suite
    app.kubernetes.io/component: primary
---
# Source: uyuni-suite/templates/service-batch.yaml
apiVersion: v1
kind: Service
metadata:
  name: "uyuni-suite-batch"
  labels:
    helm.sh/chart: uyuni-suite-0.1.0
    app.kubernetes.io/name: uyuni-suite
    app.kubernetes.io/version: "1.16.0"
    app.kubernetes.io/managed-by: Helm
spec:
  type: ClusterIP
  ports:
    - port: 8080
      targetPort: 8080
      protocol: TCP
      name: tomcat
  selector:
    app: uyuni-suite-batch
---
# Source: uyuni-suite/templates/service-core.yaml
apiVersion: v1
kind: Service
metadata:
  name: "uyuni-suite-core"
  labels:
    helm.sh/chart: uyuni-suite-0.1.0
    app.kubernetes.io/name: uyuni-suite
    app.kubernetes.io/version: "1.16.0"
    app.kubernetes.io/managed-by: Helm
spec:
  type: ClusterIP
  ports:
    - port: 8080
      targetPort: 8080
      protocol: TCP
      name: tomcat
  selector:
    app: uyuni-manager-core
---
# Source: uyuni-suite/templates/service-frontend.yaml
apiVersion: v1
kind: Service
metadata:
  name: "uyuni-suite-frontend"
  labels:
    helm.sh/chart: uyuni-suite-0.1.0
    app.kubernetes.io/name: uyuni-suite
    app.kubernetes.io/version: "1.16.0"
    app.kubernetes.io/managed-by: Helm
spec:
  type: NodePort
  ports:
    - port: 80
      targetPort: http
      protocol: TCP
      name: http
      nodePort: 30004
  selector:
    app: uyuni-suite-frontend
---
# Source: uyuni-suite/templates/service-noti.yaml
apiVersion: v1
kind: Service
metadata:
  name: "uyuni-suite-noti"
  labels:
    helm.sh/chart: uyuni-suite-0.1.0
    app.kubernetes.io/name: uyuni-suite
    app.kubernetes.io/version: "1.16.0"
    app.kubernetes.io/managed-by: Helm
spec:
  type: ClusterIP
  ports:
    - port: 8080
      targetPort: 8080
      protocol: TCP
      name: tomcat
  selector:
    app: uyuni-suite-noti
---
# Source: uyuni-suite/templates/deployment-batch.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: "uyuni-suite-batch"
  labels:
    helm.sh/chart: uyuni-suite-0.1.0
    app.kubernetes.io/name: uyuni-suite
    app.kubernetes.io/version: "1.16.0"
    app.kubernetes.io/managed-by: Helm
spec:
  replicas: 1
  selector:
    matchLabels:
      app: uyuni-suite-batch
  template:
    metadata:
      labels:
        app: uyuni-suite-batch
    spec:
      serviceAccountName: default
      securityContext:
        {}
      containers:
        - name: uyuni-suite
          securityContext:
            {}
          image: "xiilab/uyuni-manager-batch:0.4.103-stag"
          imagePullPolicy: IfNotPresent
          env:
            - name: SPRING_PROFILES_ACTIVE
              value: dev
            - name: K8S_NAMESPACE
              value: "release-4"
            - name: KEYCLOAK_REALM
              value: uyuni
            - name: KEYCLOAK_AUTHSERVERURL
              value: "http://192.168.1.235:30051/auth"
            - name: KEYCLOAK_RESOURCE
              value: uyuni
            - name: ADMIN_PASSWORD
              value: "xiilabPassword3#"
          ports:
            - name: tomcat
              containerPort: 8080
              protocol: TCP
          livenessProbe:
            httpGet:
              path: /actuator/health/liveness
              port: 8080
            initialDelaySeconds: 60
            periodSeconds: 15
          readinessProbe:
            httpGet:
              path: /actuator/health/readiness
              port: 8080
            initialDelaySeconds: 60
            periodSeconds: 10
          resources:
            {}
---
# Source: uyuni-suite/templates/deployment-core.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: uyuni-manager-core
  labels:
    helm.sh/chart: uyuni-suite-0.1.0
    app.kubernetes.io/name: uyuni-suite
    app.kubernetes.io/version: "1.16.0"
    app.kubernetes.io/managed-by: Helm
spec:
  replicas: 1
  selector:
    matchLabels:
      app: uyuni-manager-core
  template:
    metadata:
      labels:
        app: uyuni-manager-core
    spec:
      serviceAccountName: default
      securityContext:
        {}
      containers:
        - name: uyuni-suite
          securityContext:
            {}
          image: "xiilab/uyuni-manager-core:0.4.103-stag"
          imagePullPolicy: IfNotPresent
          env:
            - name: mig-profile-path
              value: /root/migProfile/migProfile.json
            - name: SPRING_PROFILES_ACTIVE
              value: dev
            - name: KEYCLOAK_REALM
              value: uyuni
            - name: KEYCLOAK_AUTHSERVERURL
              value: "http://192.168.1.235:30051/auth"
            - name: KEYCLOAK_RESOURCE
              value: uyuni
            - name: ADMIN_PASSWORD
              value: "xiilabPassword3#"
            - name: K8S_NAMESPACE
              value: "release-4"
            - name: UYUNIHOST
              value: "uyuni-suite.xiilab.com"
            - name: ADMIN_INIT-PASSWORD
              value: uyuni
            - name: KEYCLOAK_SSL-REQUIRED
              value: none
          ports:
            - name: tomcat
              containerPort: 8080
              protocol: TCP
          livenessProbe:
            httpGet:
              path: /actuator/health/liveness
              port: 8080
            initialDelaySeconds: 60
            periodSeconds: 15
          readinessProbe:
            httpGet:
              path: /actuator/health/readiness
              port: 8080
            initialDelaySeconds: 60
            periodSeconds: 10
          resources:
            {}
          volumeMounts:
            - mountPath: "/root/.kube"
              name: kube-config
              readOnly: true
            - mountPath: "/root/uyuni"
              name: uyuni-pvc
            - mountPath: "/root/migProfile"
              name: mig-profile
      volumes:
        - name: mig-profile
          configMap:
            name: mig-config
        - name: kube-config
          secret:
            secretName: kube-config
        - name: uyuni-pvc
          persistentVolumeClaim:
            claimName: "uyuni-pvc"
---
# Source: uyuni-suite/templates/deployment-frontend.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: "uyuni-suite-frontend"
  labels:
    helm.sh/chart: uyuni-suite-0.1.0
    app.kubernetes.io/name: uyuni-suite
    app.kubernetes.io/version: "1.16.0"
    app.kubernetes.io/managed-by: Helm
spec:
  replicas: 1
  selector:
    matchLabels:
      app: uyuni-suite-frontend
  template:
    metadata:
      labels:
        app: uyuni-suite-frontend
    spec:
      serviceAccountName: default
      securityContext:
        {}
      containers:
        - name: uyuni-suite
          securityContext:
            {}
          image: "xiilab/uyuni-suite-frontend:0.4.102-stag"
          imagePullPolicy: IfNotPresent
          env:
            - name: REACT_APP_KEYCLOAK_REALM
              value: uyuni
            - name: REACT_APP_KEYCLOAK_CLIENT_ID
              value: uyuni
            - name: REACT_APP_KEYCLOAK_URL
              value: "http://192.168.1.235:30051/auth"
          ports:
            - name: http
              containerPort: 80
              protocol: TCP
          livenessProbe:
            httpGet:
              path: /
              port: http
          readinessProbe:
            httpGet:
              path: /
              port: http
          resources:
            {}
          volumeMounts:
            - name: nginx-config
              mountPath: /etc/nginx/conf.d
      volumes:
        - name: nginx-config
          configMap:
            name: uyuni-suite-frontend-config
---
# Source: uyuni-suite/templates/deployment-noti.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: "uyuni-suite-noti"
  labels:
    helm.sh/chart: uyuni-suite-0.1.0
    app.kubernetes.io/name: uyuni-suite
    app.kubernetes.io/version: "1.16.0"
    app.kubernetes.io/managed-by: Helm
spec:
  replicas: 1
  selector:
    matchLabels:
      app: uyuni-suite-noti
  template:
    metadata:
      labels:
        app: uyuni-suite-noti
    spec:
      serviceAccountName: default
      securityContext:
        {}
      containers:
        - name: uyuni-suite
          securityContext:
            {}
          image: "xiilab/uyuni-manager-noti:0.4.103-stag"
          imagePullPolicy: IfNotPresent
          env:
            - name: SPRING_PROFILES_ACTIVE
              value: dev
            - name: SPRING_KAFKA_CONSUMER_BOOTSTRAP-SERVERS
              value: kafka-cp-kafka.kafka.svc:9092
            - name: SPRING_KAFKA_PRODUCER_BOOTSTRAP-SERVERS
              value: kafka-cp-kafka.kafka.svc:9092
          ports:
            - name: tomcat
              containerPort: 8080
              protocol: TCP
          livenessProbe:
            httpGet:
              path: /actuator/health/liveness
              port: 8080
            initialDelaySeconds: 60
            periodSeconds: 15
          readinessProbe:
            httpGet:
              path: /actuator/health/readiness
              port: 8080
            initialDelaySeconds: 60
            periodSeconds: 10
          resources:
            {}
---
# Source: uyuni-suite/charts/mariadb/templates/primary/statefulset.yaml
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: mariadb
  namespace: "release-4"
  labels:
    app.kubernetes.io/name: mariadb
    helm.sh/chart: mariadb-11.4.5
    app.kubernetes.io/instance: uyuni-suite
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/component: primary
spec:
  replicas: 1
  revisionHistoryLimit: 10
  selector:
    matchLabels: 
      app.kubernetes.io/name: mariadb
      app.kubernetes.io/instance: uyuni-suite
      app.kubernetes.io/component: primary
  serviceName: mariadb
  updateStrategy:
    type: RollingUpdate
  template:
    metadata:
      annotations:
        checksum/configuration: 5ff2c6662a93f590ede6b5fc3b07b0e0538fcea29d9ef5c09438e0117bc203aa
      labels:
        app.kubernetes.io/name: mariadb
        helm.sh/chart: mariadb-11.4.5
        app.kubernetes.io/instance: uyuni-suite
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/component: primary
    spec:
      
      serviceAccountName: mariadb
      affinity:
        podAffinity:
          
        podAntiAffinity:
          preferredDuringSchedulingIgnoredDuringExecution:
            - podAffinityTerm:
                labelSelector:
                  matchLabels:
                    app.kubernetes.io/name: mariadb
                    app.kubernetes.io/instance: uyuni-suite
                    app.kubernetes.io/component: primary
                topologyKey: kubernetes.io/hostname
              weight: 1
        nodeAffinity:
          
      securityContext:
        fsGroup: 1001
      containers:
        - name: mariadb
          image: docker.io/bitnami/mariadb:10.6.10-debian-11-r6
          imagePullPolicy: "IfNotPresent"
          securityContext:
            allowPrivilegeEscalation: false
            privileged: false
            runAsNonRoot: true
            runAsUser: 1001
          env:
            - name: BITNAMI_DEBUG
              value: "false"
            - name: MARIADB_ROOT_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: mariadb
                  key: mariadb-root-password
            - name: MARIADB_USER
              value: "uyuni"
            - name: MARIADB_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: mariadb
                  key: mariadb-password
            - name: MARIADB_DATABASE
              value: "uyuni"
          ports:
            - name: mysql
              containerPort: 3306
          livenessProbe:
            failureThreshold: 3
            initialDelaySeconds: 120
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 1
            exec:
              command:
                - /bin/bash
                - -ec
                - |
                  password_aux="${MARIADB_ROOT_PASSWORD:-}"
                  if [[ -f "${MARIADB_ROOT_PASSWORD_FILE:-}" ]]; then
                      password_aux=$(cat "$MARIADB_ROOT_PASSWORD_FILE")
                  fi
                  mysqladmin status -uroot -p"${password_aux}"
          readinessProbe:
            failureThreshold: 3
            initialDelaySeconds: 30
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 1
            exec:
              command:
                - /bin/bash
                - -ec
                - |
                  password_aux="${MARIADB_ROOT_PASSWORD:-}"
                  if [[ -f "${MARIADB_ROOT_PASSWORD_FILE:-}" ]]; then
                      password_aux=$(cat "$MARIADB_ROOT_PASSWORD_FILE")
                  fi
                  mysqladmin status -uroot -p"${password_aux}"
          resources: 
            limits: {}
            requests: {}
          volumeMounts:
            - name: data
              mountPath: /bitnami/mariadb
            - name: config
              mountPath: /opt/bitnami/mariadb/conf/my.cnf
              subPath: my.cnf
      volumes:
        - name: config
          configMap:
            name: mariadb
  volumeClaimTemplates:
    - metadata:
        name: data
        labels: 
          app.kubernetes.io/name: mariadb
          app.kubernetes.io/instance: uyuni-suite
          app.kubernetes.io/component: primary
      spec:
        accessModes:
          - "ReadWriteOnce"
        resources:
          requests:
            storage: "8Gi"

